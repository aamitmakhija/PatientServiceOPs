function cov_2pmrvn97h5(){var path="/Users/amitmakhija/Desktop/DevOps/api-gateway/src/app.js";var hash="5162929c22f6015221d25c8fc19ef1d72b2dbcda";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/amitmakhija/Desktop/DevOps/api-gateway/src/app.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:34}},"1":{start:{line:2,column:34},end:{line:2,column:66}},"2":{start:{line:3,column:15},end:{line:3,column:32}},"3":{start:{line:4,column:21},end:{line:4,column:47}},"4":{start:{line:7,column:0},end:{line:11,column:1}},"5":{start:{line:8,column:2},end:{line:8,column:50}},"6":{start:{line:10,column:2},end:{line:10,column:29}},"7":{start:{line:13,column:12},end:{line:13,column:21}},"8":{start:{line:15,column:0},end:{line:15,column:28}},"9":{start:{line:16,column:0},end:{line:16,column:33}},"10":{start:{line:18,column:0},end:{line:20,column:3}},"11":{start:{line:19,column:2},end:{line:19,column:90}},"12":{start:{line:23,column:23},end:{line:39,column:1}},"13":{start:{line:24,column:2},end:{line:26,column:3}},"14":{start:{line:25,column:4},end:{line:25,column:70}},"15":{start:{line:28,column:2},end:{line:38,column:5}},"16":{start:{line:33,column:6},end:{line:33,column:66}},"17":{start:{line:36,column:6},end:{line:36,column:82}},"18":{start:{line:41,column:0},end:{line:41,column:85}},"19":{start:{line:42,column:0},end:{line:42,column:76}},"20":{start:{line:43,column:0},end:{line:43,column:85}},"21":{start:{line:44,column:0},end:{line:44,column:91}},"22":{start:{line:47,column:0},end:{line:50,column:3}},"23":{start:{line:48,column:2},end:{line:48,column:45}},"24":{start:{line:49,column:2},end:{line:49,column:67}},"25":{start:{line:52,column:0},end:{line:52,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:18,column:13},end:{line:18,column:14}},loc:{start:{line:18,column:27},end:{line:20,column:1}},line:18},"1":{name:"(anonymous_1)",decl:{start:{line:23,column:23},end:{line:23,column:24}},loc:{start:{line:23,column:54},end:{line:39,column:1}},line:23},"2":{name:"(anonymous_2)",decl:{start:{line:32,column:16},end:{line:32,column:17}},loc:{start:{line:32,column:35},end:{line:34,column:5}},line:32},"3":{name:"(anonymous_3)",decl:{start:{line:35,column:16},end:{line:35,column:17}},loc:{start:{line:35,column:40},end:{line:37,column:5}},line:35},"4":{name:"(anonymous_4)",decl:{start:{line:47,column:8},end:{line:47,column:9}},loc:{start:{line:47,column:33},end:{line:50,column:1}},line:47}},branchMap:{"0":{loc:{start:{line:7,column:0},end:{line:11,column:1}},type:"if",locations:[{start:{line:7,column:0},end:{line:11,column:1}},{start:{line:7,column:0},end:{line:11,column:1}}],line:7},"1":{loc:{start:{line:24,column:2},end:{line:26,column:3}},type:"if",locations:[{start:{line:24,column:2},end:{line:26,column:3}},{start:{line:24,column:2},end:{line:26,column:3}}],line:24}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5162929c22f6015221d25c8fc19ef1d72b2dbcda"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2pmrvn97h5=function(){return actualCoverage;};}return actualCoverage;}cov_2pmrvn97h5();const express=(cov_2pmrvn97h5().s[0]++,require("express"));const{createProxyMiddleware}=(cov_2pmrvn97h5().s[1]++,require("http-proxy-middleware"));const morgan=(cov_2pmrvn97h5().s[2]++,require("morgan"));const healthRoutes=(cov_2pmrvn97h5().s[3]++,require("./routes/health"));// Load env vars
cov_2pmrvn97h5().s[4]++;if(process.env.NODE_ENV==="test"){cov_2pmrvn97h5().b[0][0]++;cov_2pmrvn97h5().s[5]++;require("dotenv").config({path:".env.test"});}else{cov_2pmrvn97h5().b[0][1]++;cov_2pmrvn97h5().s[6]++;require("dotenv").config();}const app=(cov_2pmrvn97h5().s[7]++,express());cov_2pmrvn97h5().s[8]++;app.use(morgan("combined"));cov_2pmrvn97h5().s[9]++;app.use("/health",healthRoutes);cov_2pmrvn97h5().s[10]++;app.get("/",(req,res)=>{cov_2pmrvn97h5().f[0]++;cov_2pmrvn97h5().s[11]++;res.send("Welcome to the API Gateway! Use the appropriate endpoints for the services.");});// Proxy configuration
cov_2pmrvn97h5().s[12]++;const configureProxy=(path,target,rewritePath)=>{cov_2pmrvn97h5().f[1]++;cov_2pmrvn97h5().s[13]++;if(!target){cov_2pmrvn97h5().b[1][0]++;cov_2pmrvn97h5().s[14]++;throw new Error(`[HPM] Missing "target" for proxy path: ${path}`);}else{cov_2pmrvn97h5().b[1][1]++;}cov_2pmrvn97h5().s[15]++;return createProxyMiddleware({target,changeOrigin:true,pathRewrite:{[`^${path}`]:rewritePath},onProxyReq:(proxyReq,req)=>{cov_2pmrvn97h5().f[2]++;cov_2pmrvn97h5().s[16]++;console.log(`Forwarding request: ${req.method} ${req.url}`);},onProxyRes:(proxyRes,req,res)=>{cov_2pmrvn97h5().f[3]++;cov_2pmrvn97h5().s[17]++;console.log(`Response from service: ${proxyRes.statusCode} for ${req.url}`);}});};cov_2pmrvn97h5().s[18]++;app.use("/auth",configureProxy("/auth",process.env.AUTH_SERVICE_URL,"/api/auth"));cov_2pmrvn97h5().s[19]++;app.use("/ward",configureProxy("/ward",process.env.WARD_SERVICE_URL,""));cov_2pmrvn97h5().s[20]++;app.use("/patient",configureProxy("/patient",process.env.PATIENT_SERVICE_URL,""));cov_2pmrvn97h5().s[21]++;app.use("/admission",configureProxy("/admission",process.env.ADMISSION_SERVICE_URL,""));// Error handler
cov_2pmrvn97h5().s[22]++;app.use((err,req,res,next)=>{cov_2pmrvn97h5().f[4]++;cov_2pmrvn97h5().s[23]++;console.error("Proxy error:",err.message);cov_2pmrvn97h5().s[24]++;res.status(500).send("Something went wrong in the API Gateway.");});cov_2pmrvn97h5().s[25]++;module.exports=app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMnBtcnZuOTdoNSIsImFjdHVhbENvdmVyYWdlIiwiZXhwcmVzcyIsInMiLCJyZXF1aXJlIiwiY3JlYXRlUHJveHlNaWRkbGV3YXJlIiwibW9yZ2FuIiwiaGVhbHRoUm91dGVzIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiYiIsImNvbmZpZyIsInBhdGgiLCJhcHAiLCJ1c2UiLCJnZXQiLCJyZXEiLCJyZXMiLCJmIiwic2VuZCIsImNvbmZpZ3VyZVByb3h5IiwidGFyZ2V0IiwicmV3cml0ZVBhdGgiLCJFcnJvciIsImNoYW5nZU9yaWdpbiIsInBhdGhSZXdyaXRlIiwib25Qcm94eVJlcSIsInByb3h5UmVxIiwiY29uc29sZSIsImxvZyIsIm1ldGhvZCIsInVybCIsIm9uUHJveHlSZXMiLCJwcm94eVJlcyIsInN0YXR1c0NvZGUiLCJBVVRIX1NFUlZJQ0VfVVJMIiwiV0FSRF9TRVJWSUNFX1VSTCIsIlBBVElFTlRfU0VSVklDRV9VUkwiLCJBRE1JU1NJT05fU0VSVklDRV9VUkwiLCJlcnIiLCJuZXh0IiwiZXJyb3IiLCJtZXNzYWdlIiwic3RhdHVzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XG5jb25zdCB7IGNyZWF0ZVByb3h5TWlkZGxld2FyZSB9ID0gcmVxdWlyZShcImh0dHAtcHJveHktbWlkZGxld2FyZVwiKTtcbmNvbnN0IG1vcmdhbiA9IHJlcXVpcmUoXCJtb3JnYW5cIik7XG5jb25zdCBoZWFsdGhSb3V0ZXMgPSByZXF1aXJlKFwiLi9yb3V0ZXMvaGVhbHRoXCIpO1xuXG4vLyBMb2FkIGVudiB2YXJzXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwidGVzdFwiKSB7XG4gIHJlcXVpcmUoXCJkb3RlbnZcIikuY29uZmlnKHsgcGF0aDogXCIuZW52LnRlc3RcIiB9KTtcbn0gZWxzZSB7XG4gIHJlcXVpcmUoXCJkb3RlbnZcIikuY29uZmlnKCk7XG59XG5cbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcblxuYXBwLnVzZShtb3JnYW4oXCJjb21iaW5lZFwiKSk7XG5hcHAudXNlKFwiL2hlYWx0aFwiLCBoZWFsdGhSb3V0ZXMpO1xuXG5hcHAuZ2V0KFwiL1wiLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLnNlbmQoXCJXZWxjb21lIHRvIHRoZSBBUEkgR2F0ZXdheSEgVXNlIHRoZSBhcHByb3ByaWF0ZSBlbmRwb2ludHMgZm9yIHRoZSBzZXJ2aWNlcy5cIik7XG59KTtcblxuLy8gUHJveHkgY29uZmlndXJhdGlvblxuY29uc3QgY29uZmlndXJlUHJveHkgPSAocGF0aCwgdGFyZ2V0LCByZXdyaXRlUGF0aCkgPT4ge1xuICBpZiAoIXRhcmdldCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgW0hQTV0gTWlzc2luZyBcInRhcmdldFwiIGZvciBwcm94eSBwYXRoOiAke3BhdGh9YCk7XG4gIH1cblxuICByZXR1cm4gY3JlYXRlUHJveHlNaWRkbGV3YXJlKHtcbiAgICB0YXJnZXQsXG4gICAgY2hhbmdlT3JpZ2luOiB0cnVlLFxuICAgIHBhdGhSZXdyaXRlOiB7IFtgXiR7cGF0aH1gXTogcmV3cml0ZVBhdGggfSxcbiAgICBvblByb3h5UmVxOiAocHJveHlSZXEsIHJlcSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coYEZvcndhcmRpbmcgcmVxdWVzdDogJHtyZXEubWV0aG9kfSAke3JlcS51cmx9YCk7XG4gICAgfSxcbiAgICBvblByb3h5UmVzOiAocHJveHlSZXMsIHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgUmVzcG9uc2UgZnJvbSBzZXJ2aWNlOiAke3Byb3h5UmVzLnN0YXR1c0NvZGV9IGZvciAke3JlcS51cmx9YCk7XG4gICAgfSxcbiAgfSk7XG59O1xuXG5hcHAudXNlKFwiL2F1dGhcIiwgY29uZmlndXJlUHJveHkoXCIvYXV0aFwiLCBwcm9jZXNzLmVudi5BVVRIX1NFUlZJQ0VfVVJMLCBcIi9hcGkvYXV0aFwiKSk7XG5hcHAudXNlKFwiL3dhcmRcIiwgY29uZmlndXJlUHJveHkoXCIvd2FyZFwiLCBwcm9jZXNzLmVudi5XQVJEX1NFUlZJQ0VfVVJMLCBcIlwiKSk7XG5hcHAudXNlKFwiL3BhdGllbnRcIiwgY29uZmlndXJlUHJveHkoXCIvcGF0aWVudFwiLCBwcm9jZXNzLmVudi5QQVRJRU5UX1NFUlZJQ0VfVVJMLCBcIlwiKSk7XG5hcHAudXNlKFwiL2FkbWlzc2lvblwiLCBjb25maWd1cmVQcm94eShcIi9hZG1pc3Npb25cIiwgcHJvY2Vzcy5lbnYuQURNSVNTSU9OX1NFUlZJQ0VfVVJMLCBcIlwiKSk7XG5cbi8vIEVycm9yIGhhbmRsZXJcbmFwcC51c2UoKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc29sZS5lcnJvcihcIlByb3h5IGVycm9yOlwiLCBlcnIubWVzc2FnZSk7XG4gIHJlcy5zdGF0dXMoNTAwKS5zZW5kKFwiU29tZXRoaW5nIHdlbnQgd3JvbmcgaW4gdGhlIEFQSSBHYXRld2F5LlwiKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGFwcDsiXSwibWFwcGluZ3MiOiJ3eUdBZVk7QUFBQUEsY0FBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxjQUFBLEdBZlosS0FBTSxDQUFBRSxPQUFPLEVBQUFGLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQ2xDLEtBQU0sQ0FBRUMscUJBQXNCLENBQUMsRUFBQUwsY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxFQUNsRSxLQUFNLENBQUFFLE1BQU0sRUFBQU4sY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUMsRUFDaEMsS0FBTSxDQUFBRyxZQUFZLEVBQUFQLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsRUFFL0M7QUFBQUosY0FBQSxHQUFBRyxDQUFBLE1BQ0Es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